<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Conclusiones</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <h1>Conclusiones sobre los nacimientos en Pereira 2020</h1>

  <div id="resumen"></div>

  <script>
    d3.csv("data/nacimientos_pereira2020.csv").then(data => {
      // Total de nacimientos
      let total = data.length;

      // Porcentaje por sexo
      let conteoSexo = d3.rollup(data, v => v.length, d => d.SEXO);
      let masculino = conteoSexo.get("MASCULINO") || 0;
      let femenino = conteoSexo.get("FEMENINO") || 0;
      let porcentajeM = ((masculino / total) * 100).toFixed(1);
      let porcentajeF = ((femenino / total) * 100).toFixed(1);

      // Régimen de salud más frecuente
      let conteoRegimen = d3.rollup(data, v => v.length, d => d.REGIMEN_SALUD);
      let regimenTop = Array.from(conteoRegimen.entries()).sort((a, b) => b[1] - a[1])[0];

      // Zona más frecuente
      let conteoZona = d3.rollup(data, v => v.length, d => d.ZONA);
      let zonaTop = Array.from(conteoZona.entries()).sort((a, b) => b[1] - a[1])[0];

      // Construir HTML
      let resumenHTML = `
        <p><strong>Total de nacimientos registrados:</strong> ${total}</p>
        <p><strong>Distribución por sexo:</strong> Masculino ${porcentajeM}% (${masculino}), Femenino ${porcentajeF}% (${femenino})</p>
        <p><strong>Régimen de salud predominante:</strong> ${regimenTop[0]} (${regimenTop[1]} nacimientos)</p>
        <p><strong>Zona predominante:</strong> ${zonaTop[0]} (${zonaTop[1]} nacimientos)</p>
      `;

      document.getElementById("resumen").innerHTML = resumenHTML;
    });
  </script>
</body>
</html>