<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Conclusiones</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <header>
    <nav id="primary-navigation" class="navbar">
      <div class="logo">üìä Datos Abiertos</div>
      <button id="menuToggle" class="menu-toggle" aria-expanded="false" aria-label="Abrir men√∫">‚ò∞</button>
      <ul id="navLinks" class="menu">
        <li><a href="index.html">Inicio</a></li>
        <li><a href="general.html">Estad√≠sticas Generales</a></li>
        <li><a href="detalles.html">An√°lisis Detallado</a></li>
        <li><a href="conclusiones.html">Conclusiones</a></li>
      </ul>
    </nav>
  </header>

  <script src="script.js"></script>

  <main>
    <h1>Conclusiones sobre los nacimientos en Pereira (2020 - 2024)</h1>

    <div id="resumen" class="card"></div>
    <div id="conclusionFinal" class="card conclusion"></div>
  </main>

  <script>
    d3.dsv(";", "nacimientos_pereira2020_1.csv").then(data => {
      let total = data.length;

      data.forEach(d => {
        d.Sexo = (d["Sexo"] || "").trim().toUpperCase();
        d.Regimen = (d["Regimen Salud"] || "").trim().toUpperCase();
        d.Zona = (d["Zona (U=urbana; R=rural)"] || "").trim().toUpperCase();
      });

      let conteoSexo = d3.rollup(data, v => v.length, d => d.Sexo);
      let masculino = conteoSexo.get("MASCULINO") || 0;
      let femenino = conteoSexo.get("FEMENINO") || 0;
      let porcentajeM = ((masculino / total) * 100).toFixed(1);
      let porcentajeF = ((femenino / total) * 100).toFixed(1);

      let conteoRegimen = d3.rollup(data, v => v.length, d => d.Regimen);
      let regimenTop = Array.from(conteoRegimen.entries()).sort((a, b) => b[1] - a[1])[0];

      let conteoZona = d3.rollup(data, v => v.length, d => d.Zona);
      let zonaTop = Array.from(conteoZona.entries()).sort((a, b) => b[1] - a[1])[0];

      let resumenHTML = `
        <p><strong>Total de nacimientos registrados:</strong> ${total}</p>
        <p><strong>Distribuci√≥n por sexo:</strong> Masculino ${porcentajeM}% (${masculino}), 
        Femenino ${porcentajeF}% (${femenino})</p>
        <p><strong>R√©gimen de salud predominante:</strong> ${regimenTop[0]} (${regimenTop[1]} nacimientos)</p>
        <p><strong>Zona con mayor concentraci√≥n:</strong> ${zonaTop[0]} (${zonaTop[1]} nacimientos)</p>
      `;
      document.getElementById("resumen").innerHTML = resumenHTML;

      let conclusionHTML = `
        <h2>Conclusi√≥n general</h2>
        <p>Los datos muestran que la mayor√≠a de los nacimientos en Pereira entre 2020 y 2024 
        corresponden a <strong>hombres</strong>, ocurren principalmente en la 
        <strong>${zonaTop[0].toLowerCase()}</strong> y est√°n asociados al r√©gimen de salud 
        <strong>${regimenTop[0].toLowerCase()}</strong>. 
        Esto refleja una fuerte centralizaci√≥n de los servicios de salud en el √°rea urbana 
        y un predominio del r√©gimen contributivo, aunque tambi√©n se evidencia una presencia 
        significativa del r√©gimen subsidiado. 
        En general, los nacimientos se concentran en mujeres j√≥venes residentes en la cabecera municipal, 
        lo que destaca la necesidad de fortalecer la atenci√≥n en zonas rurales y poblaciones vulnerables.</p>
      `;
      document.getElementById("conclusionFinal").innerHTML = conclusionHTML;
    });
  </script>
</body>
</html>